(()=>{"use strict";var e=[function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),s=n(3),c=n(5);new(function(e){function t(){var t=e.call(this,"main")||this;(new c.XStage).addChild(t),t.percentWidth=100,t.percentHeight=100,t.background="rgba(0,0,0,0.5)",t.addEventListener("onClick",(function(e){console.log("main click!")}));var n=new s.XSprite;n.x=200,n.y=300,t.addChild(n);var r=new i.XLabel("textNode");return r.text="textNode",n.addChild(r),r.addEventListener("onClick",(function(e){console.log("text click!")})),t}return o(t,e),t}(s.XSprite))},function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.XLabel=void 0;var i=n(2),s=function(e){function t(t){var n=e.call(this,t)||this;return n._text="",n.background="",n.style.width="",n.style.height="",n}return o(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e},enumerable:!1,configurable:!0}),t.prototype.getVNode=function(){return(0,i.m)("span",this.getProps(),[this._text],i.VFlags.ONLY_TEXT_CHILDREN)},t}(n(3).XSprite);t.XLabel=s},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=()=>(e,t,n,r=[])=>{const o=n?.props??{},i=t.props??{};for(const t in{...o,...i}){const n=o[t],s=i[t];if(n!==s)if(t.startsWith("on")){const o=t.slice(2).toLowerCase();r.push((()=>{n&&e.removeEventListener(o,n),e.addEventListener(o,s)}))}else void 0===e[t]||e instanceof SVGElement?s?r.push((()=>e.setAttribute(t,String(s)))):r.push((()=>e.removeAttribute(t))):s?r.push((()=>e[t]=s)):r.push((()=>{e.removeAttribute(t),delete e[t]}))}return{el:e,newVNode:t,oldVNode:n,workStack:r}},r="__m_old_vnode";var o;t.VFlags=void 0,(o=t.VFlags||(t.VFlags={}))[o.IGNORE_NODE=0]="IGNORE_NODE",o[o.REPLACE_NODE=1]="REPLACE_NODE",o[o.NO_CHILDREN=2]="NO_CHILDREN",o[o.ONLY_TEXT_CHILDREN=3]="ONLY_TEXT_CHILDREN",o[o.ONLY_KEYED_CHILDREN=4]="ONLY_KEYED_CHILDREN",o[o.ANY_CHILDREN=5]="ANY_CHILDREN";const i=()=>(e,n,r,o=[])=>{const i={el:e,newVNode:n,oldVNode:r,workStack:o};if(n.flag===t.VFlags.IGNORE_NODE)return i;if(n.flag===t.VFlags.REPLACE_NODE)return e.replaceWith(a(n)),i;const s=r?.children??[],c=n.children,u=n.delta;if(u){for(let t=0;t<u.length;++t){const[n,r]=u[t],i=e.childNodes[r];switch(n){case 0:o.push((()=>e.insertBefore(a(c[r]),i)));break;case 1:l(i,c[r],s[r]);break;case 2:o.push((()=>e.removeChild(i)))}}return i}if(!c||n.flag===t.VFlags.NO_CHILDREN)return s?(o.push((()=>e.textContent="")),i):i;if(void 0===n.flag||n.flag===t.VFlags.ANY_CHILDREN){if(s)for(let t=s.length-1;t>=0;--t)l(e.childNodes[t],c[t],s[t]);for(let t=s.length??0;t<c.length;++t){const n=a(c[t],!1);o.push((()=>e.appendChild(n)))}return i}if(n.flag===t.VFlags.ONLY_TEXT_CHILDREN)return o.push((()=>e.textContent=n.children.join(""))),i;if(n.flag===t.VFlags.ONLY_KEYED_CHILDREN){let t=0,n=0,r=s.length-1,l=c.length-1;for(;t<=r&&n<=l&&s[r].key===c[l].key;)r--,l--;for(;t<=r&&n<=l&&s[t].key===c[n].key;)t++,n++;if(t>r)for(;n<=l;){const t=n++;o.push((()=>e.insertBefore(a(c[t],!1),e.childNodes[t])))}else if(n>l)for(;t<=r;){const n=e.childNodes[t++];o.push((()=>e.removeChild(n)))}else{const i={};for(let e=r;e>=t;--e)i[s[e].key]=e;for(;n<=l;){const t=c[n],r=i[t.key],l=e.childNodes[r],u=n++;void 0!==r&&t.key===s[r].key?(u!==r&&o.push((()=>e.insertBefore(l,e.childNodes[u]))),delete i[t.key]):o.push((()=>e.insertBefore(a(t,!1),e.childNodes[u])))}for(const t of Object.values(i)){const n=e.childNodes[t];o.push((()=>e.removeChild(n)))}}return i}return i},s=(e=[],t=(e=>e()))=>{for(let n=0;n<e.length;++n)t(e[n])},c=(e=[])=>(t,n,r,o=[])=>{const i=e=>(o.push((()=>{r||(e.__m_old_vnode=n)})),{el:e,newVNode:n,oldVNode:r,workStack:o});if(!n&&""!==n)return o.push((()=>t.remove())),i(t);{const s=r??t.__m_old_vnode,c="string"==typeof s||"string"==typeof n;if(c&&s!==n){const e=a(n);return o.push((()=>t.replaceWith(e))),i(e)}if(!c){const r=s,c=n;if(void 0===r?.key&&void 0===c?.key||r?.key!==c?.key){if(r?.tag!==c?.tag||t instanceof Text){const e=a(n);return o.push((()=>t.replaceWith(e))),i(e)}for(let n=0;n<e.length;++n)e[n](t,c,r,o)}}}return i(t)},l=(e,t,r,o=[])=>{const l=c([i(),n()])(e,t,r,o);return s(l.workStack),l.el},u=n(),a=(e,t=!0)=>{if("string"==typeof e)return document.createTextNode(e);const n=e.props?.ns?document.createElementNS(e.props?.ns,e.tag):document.createElement(e.tag);if(s(u(n,e).workStack),e.children)for(let t=0;t<e.children.length;++t)n.appendChild(a(e.children[t]));return t&&(n.__m_old_vnode=e),n},p=(e,t,n)=>{if(t.className&&(t.class=t.className,delete t.className),t.ns="http://www.w3.org/2000/svg",n&&"foreignObject"!==e)for(const e of n)"string"!=typeof e&&e.props&&p(e.tag,e.props,e.children)},d=(e,t,n,r,o)=>{let i;return t?.key&&(i=t.key,delete t.key),{tag:e,props:t,children:n,key:i,flag:r,delta:o}},h=e=>{if(e.__m_old_vnode)return e.__m_old_vnode;if(e instanceof Text)return String(e.nodeValue);const t={},n=new Array(e.children.length).fill(0);for(let n=0;n<e.attributes.length;n++)t[e.attributes[n].nodeName]=e.attributes[n].nodeValue;for(let t=0;t<e.childNodes.length;t++)n[t]=h(e.childNodes[t]);const r=d(e.tagName,t,n);return e.__m_old_vnode=r,r},f=[],_=Promise.resolve();let g=0,y=!1;const b=()=>navigator?.scheduling?.isInputPending({includeContinuous:!0})||performance.now()>=g,v=()=>{for(g=performance.now()+16.666666666666668;!b();){const e=f.shift();if(!e)break;e()}y=!1,f.length>0&&N()},N=()=>{y||queueMicrotask((()=>{_.then(v),y=!0}))};t.DELETE=(e=0)=>[2,e],t.INSERT=(e=0)=>[0,e],t.OLD_VNODE_FIELD=r,t.UPDATE=(e=0)=>[1,e],t.childrenDriver=i,t.className=e=>Object.keys(e).filter((t=>e[t])).join(" "),t.compose=c,t.createElement=a,t.flush=v,t.flushWorkStack=s,t.kebab=e=>{const t={};for(const n in e)t[n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()]=e[n];return t},t.m=d,t.nextTick=N,t.ns=p,t.patch=l,t.propsDriver=n,t.schedule=e=>{f.push(e),N()},t.shouldYield=b,t.style=e=>Object.entries(e).map((e=>e.join(":"))).join(";"),t.svg=e=>(e.props||(e.props={}),p(e.tag,e.props,e.children),e),t.toVNode=h},function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.XSprite=void 0;var i=n(2),s=function(e){function t(t){var n=e.call(this)||this;return n.events={onClick:function(e){e.stopPropagation()}},n._childrens=[],n._id=t||"obj_"+n.createId,n.style={position:"absolute",display:"inline-block",left:"0px",top:"0px",width:"100px",height:"100px",background:"rgba(0,0,0,.05)"},n}return o(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stage",{get:function(){return this._stage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return parseInt(this.style.width)},set:function(e){this.style.width=e+"px",this.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return parseInt(this.style.height)},set:function(e){this.style.height=e+"px",this.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentWidth",{get:function(){return parseInt(this.style.width)},set:function(e){this.style.width=e+"%",this.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentHeight",{get:function(){return parseInt(this.style.height)},set:function(e){this.style.height=e+"%",this.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return parseInt(this.style.left)},set:function(e){this.style.left=e+"px",this.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return parseInt(this.style.top)},set:function(e){this.style.top=e+"px",this.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this.style.background},set:function(e){this.style.background=e,this.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numChildren",{get:function(){return this._childrens.length},enumerable:!1,configurable:!0}),t.prototype.addChild=function(e){return e._parent=this,e._stage=this.stage,this._childrens.push(e),this.render(),e},t.prototype.addChildAt=function(e,t){return e._parent=this,e._stage=this.stage,this._childrens.splice(t,0,e),this.render(),e},t.prototype.removeChild=function(e){e._parent=void 0,e._stage=void 0;var t=this._childrens.findIndex((function(t){return t==e}));return this._childrens.splice(t,1),this.render(),e},t.prototype.removeChildAt=function(e){var t=this._childrens.splice(e,1)[0];return t._parent=void 0,t._stage=void 0,this.render(),t},t.prototype.removeChildren=function(){this._childrens.map((function(e){e._parent=void 0,e._stage=void 0})),this._childrens.length=0,this.render()},t.prototype.getChildAt=function(e){return this._childrens[e]},t.prototype.addEventListener=function(e,t){var n=this;this.events[e]=function(r){r.stopPropagation(),t({eventName:e,currentTarget:n})},this.render()},t.prototype.removeEventListener=function(e){this.events[e]=function(e){e.stopPropagation()},this.render()},t.prototype.getProps=function(){var e=this,t={id:this.id,style:(0,i.style)(this.style)};return Object.keys(this.events).forEach((function(n){return t[n]=e.events[n]})),t},t.prototype.getVNode=function(){return(0,i.m)("div",this.getProps(),this._childrens.map((function(e){return e.getVNode()})))},t.prototype.render=function(){var e=document.getElementById(this.id);e&&(0,i.patch)(e,this.getVNode())},t}(n(4).XObject);t.XSprite=s},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XObject=void 0;var n=function(){function e(){this._createId=0,this._createId=++e.createIdCounter}return Object.defineProperty(e.prototype,"createId",{get:function(){return this._createId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this.constructor.name},enumerable:!1,configurable:!0}),e.createIdCounter=0,e}();t.XObject=n},function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.XStage=void 0;var i=n(2),s=function(e){function t(){var t=e.call(this,"stage")||this;return t.percentWidth=100,t.percentHeight=100,t.background="rgb(0,0,0,0)",t._stage=t,document.body.append((0,i.createElement)(t.getVNode())),t}return o(t,e),t}(n(3).XSprite);t.XStage=s}],t={};(function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports})(0)})();